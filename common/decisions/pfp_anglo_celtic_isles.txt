pfp_category = {
    pfp_anglo_celtic_isles = {
        allowed = {
        NOT = {
            original_tag = ENG #England
            original_tag = IRE #Ireland
            original_tag = NIR #Northern Ireland
            original_tag = SCO #Scotland
            original_tag = WLS #Wales
            original_tag = P02 #Anglo-Celtic Isles
            }
        }
        available = {
            is_subject = no
            #Leinster
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_leinster
                controls_state = 113 #Leinster
            }
            #Northern Ireland
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_northern_ireland
                controls_state = 119 #Northern Ireland
            }
            #Scottish Highlands
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_scottish_highlands
                controls_state = 120 #Scottish Highlands
            }
            #Lothian
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_lothian
                controls_state = 121 #Lothian
            }
            #Wales
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_wales
                controls_state = 122 #Wales
            }
            #South-West England
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_south_west_england
                controls_state = 123 #South-West England
            }
            #East Anglia
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_east_anglia
                controls_state = 125 #East Anglia
            }
            #Greater London Area
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_greater_london_area
                controls_state = 126 #Greater London Area
            }
            #Sussex
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_sussex
                controls_state = 127 #Sussex
            }
            #West Midlands
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_west_midlands
                controls_state = 128 #West Midlands
            }
            #East Midlands
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_east_midlands
                controls_state = 129 #East Midlands
            }
            #Yorkshire
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_yorkshire
                controls_state = 130 #Yorkshire
            }
            #Northumberland
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_northumberland
                controls_state = 131 #Northumberland
            }
            #Lancashire
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_lancashire
                controls_state = 132 #Lancashire
            }
            #Lanark
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_lanark
                controls_state = 133 #Lanark
            }
            #Connaught
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_connaught
                controls_state = 134 #Connaught
            }
            #Munster
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_munster
                controls_state = 135 #Munster
            }
            #Aberdeenshire
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_aberdeenshire
                controls_state = 136 #Aberdeenshire
            }
            #Gloucestershire
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_gloucestershire
                controls_state = 338 #Gloucestershire
            }
            #Cumbria
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_cumbria
                controls_state = 1041 #Cumbria
            }
            #Isle of Man
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_isle_of_man
                controls_state = 1042 #Isle of Man
            }
            #Shetland Islands
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_shetland_islands
                controls_state = 970 #Shetland Islands
            }
            #Orkney
            custom_trigger_tooltip = {
                tooltip = pfp_anglo_celtic_isles_required_states_orkney
                controls_state = 971 #Orkney
            }
        }
        visible = {
            OR = {
                controls_state = 113 #Dublin
                controls_state = 121 #Lothian
                controls_state = 122 #Wales
                controls_state = 126 #London
            }
            NOT = {
                original_tag = ENG #England
                original_tag = IRE #Ireland
                original_tag = NIR #Northern Ireland
                original_tag = SCO #Scotland
                original_tag = WLS #Wales
                original_tag = P02 #Anglo-Celtic Isles
                has_global_flag = pfp_anglo_celtic_isles_flag
            }   
        }
        complete_effect = {
            custom_effect_tooltip = pfp_anglo_celtic_isles_coring_states
            custom_effect_tooltip = pfp_anglo_celtic_isles_transfer_states
            custom_effect_tooltip = pfp_anglo_celtic_isles_puppet

            #Create formable puppet with all its states and then puppet
            hidden_effect = {
                set_variable = { is_creating_formable_puppet = yes }
                pfp_release_anglo_celtic_isles = yes

                if = {
                    limit = { has_dlc = "Together for Victory" }
                    set_autonomy = { target = P02 autonomy_state = autonomy_military_administration }
                }
                else = {
                    puppet = P02
                }
                clear_variable = is_creating_formable_puppet
            }
        }
        ai_will_do = {
            factor = 0
        }
    }
}